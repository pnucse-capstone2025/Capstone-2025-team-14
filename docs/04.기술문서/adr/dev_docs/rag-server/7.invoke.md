# result = rag_chain.invoke(query)

- rag_chain을 실행할 때 사용하는 함수이다.
- 체인의 작업을 수행하고, 그 결과를 반환하는데, 반환되는 값은 보통 딕셔너리 형태고 체인의 각 단계를 거친 결과물을 포함한다.

## result가 담고 있는 항목
- llm_output : LLM 출력. 이것도 딕셔너리 구조일 수 있다.
- source_documents : 참조한 문서들의 목록. 각 문서는 page_content 등의 속성을 포함할 수 있다.
- 기타 정보 : 필요에 따라 log, attribution(출처) 등도 포함된다.

### 예시
```json
result = rag_chain.invoke(query)

# 예시 반환값
{
    "llm_output": {
        "yaml": "generated YAML content", 
        "attributions": "source attribution data"
    },
    "source_documents": [
        {"page_content": "content of the first document"},
        {"page_content": "content of the second document"}
    ],
    "log": "response was created by model X using provider Y"
}
```

## invoke 호출 흐름

1. 쿼리 입력 
2. 작업 수행 
    - e.g. 문서 검색, LLM 응답 생성, 출력 포맷팅 등
3. 결과 반환
    - 최종 결과가 딕셔너리 형태로 반환된다.
        - 답변, 참조된 문서, 기타 메타데이터가 포함된다.

## 일반적인 포맷

1. 답변 생성 (기본 RAG)
```yml
{
    "question": "What is the capital of France?",
    "answer": "The capital of France is Paris.",
    "sources": ["Document 1: France Geography", "Document 2: European Capitals"],
    "log": "response was created by GPT-4 using 'stuff' template"
}
```

2. YAML 생성
```
{
    "question": "How to configure a web server?",
    "answer": "Refer to the generated YAML file.",
    "yaml": "server_configuration:\n  host: example.com\n  port: 80\n",
    "attributions": "Generated from Document A and Document B",
    "sources": ["Document 1: Web Server Setup", "Document 2: Server Configuration Basics"],
    "log": "response was created by GPT-4 using 'yaml_generation' template with attribution"
}
```

```
result = rag_chain.invoke({
    "query": "What is the capital of France?",
    "context": "Geography-related content",
    "metadata": {"timestamp": "2025-08-30", "user": "admin"}
})

```