| Source | 내용 |
|--------|------|
| **source_1** | # Kubernetes 배포를 위한 조직 내부 데이터 정의 <br> ## 배포 환경 <br> > ### MSA 애플리케이션 정의 <br> - 서비스 설명 <br> - 서비스 이름: 선물하기 서비스 (Gift Service) <br> - 구성 마이크로서비스 목록: <br> &nbsp;&nbsp;- api-gateway: 모든 MSA 요청에 대한 인증 및 라우팅을 담당하는 관문 서비스입니다. <br> &nbsp;&nbsp;- user-service: 사용자 회원가입, 로그인, 정보 관리를 담당합니다. <br> &nbsp;&nbsp;- product-service: 상품 정보, 재고, 옵션을 관리합니다. <br> &nbsp;&nbsp;- wish-service: 사용자의 위시리스트를 관리합니다. |
| **source_2** | - wish-service: 사용자의 위시리스트를 관리합니다. <br> - order-service: 상품 주문 및 카카오톡 메시지 발송을 처리합니다. <br> - gift-app: 사용자를 위한 웹 UI를 제공하는 BFF(Backend for Frontend) 서비스입니다. <br> - 의존 서비스 <br> &nbsp;&nbsp;- gift-app: api-gateway에 의존하여 모든 백엔드 API를 호출합니다. <br> &nbsp;&nbsp;- api-gateway: user-service, product-service, wish-service, order-service로 요청을 라우팅합니다. <br> &nbsp;&nbsp;- order-service: product-service (재고 차감), wish-service (주문 후 위시리스트 삭제), user-service (카카오 토큰 조회)에 의존합니다. |
| **source_3** | - wish-service: product-service (상품 정보 조회)에 의존합니다. <br> - user-service, product-service: 다른 서비스에 대한 직접적인 의존성 없이 독립적으로 실행됩니다. <br> - 볼륨 구성 <br> &nbsp;&nbsp;- 애플리케이션은 상태 비저장(Stateless)으로 설계되어, 별도의 영구 볼륨(Persistent Volume)을 사용하지 않습니다. 모든 데이터는 외부 데이터베이스에 저장됩니다. <br> - 내부 서비스 포트 (Service Port) <br> &nbsp;&nbsp;- api-gateway-svc: 8080 <br> &nbsp;&nbsp;- user-service-svc: 8084 <br> &nbsp;&nbsp;- product-service-svc: 8081 <br> &nbsp;&nbsp;- wish-service-svc: 8082 <br> &nbsp;&nbsp;- order-service-svc: 8083 |
| **source_4** | - user-service-svc: 8084 <br> - product-service-svc: 8081 <br> - wish-service-svc: 8082 <br> - order-service-svc: 8083 <br> - gift-app-svc: 8080 (외부 포트) -> 8085 (내부 컨테이너 포트) <br> - 외부 노출 방식 <br> &nbsp;&nbsp;- gift-app-svc: LoadBalancer 타입을 사용하여 외부 트래픽을 서비스의 8080 포트로 전달합니다. 이 트래픽은 gift-app 컨테이너의 8085 포트로 전달됩니다. <br> &nbsp;&nbsp;- 기타 모든 서비스: ClusterIP 타입을 사용하여 클러스터 내부에서만 통신합니다. 외부 요청은 모두 api-gateway를 통해서만 내부 서비스로 전달됩니다. |
| **source_5** | > ### 마이크로서비스 기본 정보 (api-gateway) <br> - 컨테이너 이미지 및 버전 정보: sk124590/api-gateway:2.1 <br> - 마이크로서비스 포트: 8080 <br> - 환경 변수: <br> &nbsp;&nbsp;- ConfigMap (gift-config) <br> &nbsp;&nbsp;&nbsp;&nbsp;- SERVICE_USER_URI: http://user-service-svc:8084 <br> &nbsp;&nbsp;&nbsp;&nbsp;- SERVICE_PRODUCT_URI: http://product-service-svc:8081 <br> &nbsp;&nbsp;&nbsp;&nbsp;- SERVICE_WISH_URI: http://wish-service-svc:8082 <br> &nbsp;&nbsp;&nbsp;&nbsp;- SERVICE_ORDER_URI: http://order-service-svc:8083 <br> &nbsp;&nbsp;- Secret (gift-secret) <br> &nbsp;&nbsp;&nbsp;&nbsp;- JWT_SECRET: WW4ya2ppYmRkRkFXdG5QSjJBRmxMOFdYbW9oSk1DdmlnUWdnYUV5cGE1RT0= (Base64 Encoded) <br> - 리소스 설정: <br> &nbsp;&nbsp;- requests: cpu: "100m", memory: "256Mi" <br> &nbsp;&nbsp;- limits: cpu: "500m", memory: "512Mi" <br> - 복제 수 (Replicas): 1 |
| **source_6** | - 리소스 설정: <br> &nbsp;&nbsp;- requests: cpu: "100m", memory: "256Mi" <br> &nbsp;&nbsp;- limits: cpu: "500m", memory: "512Mi" <br> - 복제 수 (Replicas): 1 <br> > ### 마이크로서비스 기본 정보 (user-service) <br> - 컨테이너 이미지 및 버전 정보: sk124590/user-service:2.1 <br> - 마이크로서비스 포트: 8084 <br> - 환경 변수: <br> &nbsp;&nbsp;- Secret (gift-secret) <br> &nbsp;&nbsp;&nbsp;&nbsp;- JWT_SECRET: WW4ya2... <br> &nbsp;&nbsp;&nbsp;&nbsp;- KAKAO_CLIENT_ID: YWMyMGQ4NGY5N2I2NzlmMGJiZDlhODA2NWJhODIzZjM= <br> &nbsp;&nbsp;&nbsp;&nbsp;- KAKAO_CLIENT_SECRET: RnczSmlMNVBrcGV2WFZaOU9pVk04YmZiZ0hVUEQ1RUE= <br> &nbsp;&nbsp;- ConfigMap (gift-config) <br> &nbsp;&nbsp;&nbsp;&nbsp;- KAKAO_REDIRECT_URI: http://localhost:8080/members/login/oauth2/code/kakao |
| **source_7** | - ConfigMap (gift-config) <br> &nbsp;&nbsp;- KAKAO_REDIRECT_URI: http://localhost:8080/members/login/oauth2/code/kakao <br> - 리소스 설정: <br> &nbsp;&nbsp;- requests: cpu: "150m", memory: "512Mi" <br> &nbsp;&nbsp;- limits: cpu: "1000m", memory: "1Gi" <br> - 복제 수 (Replicas): 1 <br> > ### 마이크로서비스 기본 정보 (gift-app) <br> - 컨테이너 이미지 및 버전 정보: sk124590/gift-app:2.1 <br> - 마이크로서비스 포트: 8085 <br> - 환경 변수: <br> &nbsp;&nbsp;- ConfigMap (gift-config) <br> &nbsp;&nbsp;&nbsp;&nbsp;- API_GATEWAY_URI: http://api-gateway-svc:8080 <br> &nbsp;&nbsp;&nbsp;&nbsp;- KAKAO_REDIRECT_URI: http://localhost:8080/members/login/oauth2/code/kakao <br> &nbsp;&nbsp;- Secret (gift-secret) <br> &nbsp;&nbsp;&nbsp;&nbsp;- JWT_SECRET: WW4ya2... |
| **source_8** | - Secret (gift-secret) <br> &nbsp;&nbsp;- JWT_SECRET: WW4ya2... <br> &nbsp;&nbsp;- KAKAO_CLIENT_ID: YWMyMGQ4... <br> &nbsp;&nbsp;- KAKAO_CLIENT_SECRET: RnczSmlM... <br> - 리소스 설정: <br> &nbsp;&nbsp;- requests: cpu: "100m", memory: "512Mi" <br> &nbsp;&nbsp;- limits: cpu: "500m", memory: "1Gi" <br> - 복제 수 (Replicas): 1 <br> > ### 마이크로서비스 기본 정보 (product-service) <br> - 컨테이너 이미지 및 버전 정보: sk124590/product-service:2.1 <br> - 마이크로서비스 포트: 8081 <br> - 환경 변수: 없음 <br> - 리소스 설정: <br> &nbsp;&nbsp;- requests: cpu: "150m", memory: "512Mi" |
| **source_9** | - 환경 변수: 없음 <br> - 리소스 설정: <br> &nbsp;&nbsp;- requests: cpu: "150m", memory: "512Mi" <br> &nbsp;&nbsp;- limits: cpu: "1000m", memory: "1Gi" <br> - 복제 수 (Replicas): 1 <br> > ### 마이크로서비스 기본 정보 (wish-service) <br> - 컨테이너 이미지 및 버전 정보: sk124590/wish-service:2.1 <br> - 마이크로서비스 포트: 8082 <br> - 환경 변수: <br> &nbsp;&nbsp;- ConfigMap (gift-config) <br> &nbsp;&nbsp;&nbsp;&nbsp;- SERVICE_PRODUCT_URI: http://product-service-svc:8081 <br> - 리소스 설정: <br> &nbsp;&nbsp;- requests: cpu: "100m", memory: "512Mi" <br> &nbsp;&nbsp;- limits: cpu: "700m", memory: "1Gi" <br> - 복제 수 (Replicas): 1 <br> > ### 마이크로서비스 기본 정보 (order-service) <br> - 컨테이너 이미지 및 버전 정보: sk124590/order-service:2.1 |
| **source_10** | > ### 마이크로서비스 기본 정보 (order-service) <br> - 컨테이너 이미지 및 버전 정보: sk124590/order-service:2.1 <br> - 마이크로서비스 포트: 8083 <br> - 환경 변수: <br> &nbsp;&nbsp;- ConfigMap (gift-config) <br> &nbsp;&nbsp;&nbsp;&nbsp;- SERVICE_PRODUCT_URI: http://product-service-svc:8081 <br> &nbsp;&nbsp;&nbsp;&nbsp;- SERVICE_WISH_URI: http://wish-service-svc:8082 <br> &nbsp;&nbsp;&nbsp;&nbsp;- SERVICE_USER_URI: http://user-service-svc:8084 <br> &nbsp;&nbsp;&nbsp;&nbsp;- FRONT_DOMAIN: http://localhost:8080 <br> &nbsp;&nbsp;- Secret (gift-secret) <br> &nbsp;&nbsp;&nbsp;&nbsp;- KAKAO_CLIENT_ID: YWMyMGQ4... <br> &nbsp;&nbsp;&nbsp;&nbsp;- KAKAO_CLIENT_SECRET: RnczSmlM... <br> - 리소스 설정: <br> &nbsp;&nbsp;- requests: cpu: "100m", memory: "512Mi" <br> &nbsp;&nbsp;- limits: cpu: "700m", memory: "1Gi" |
| **source_11** | - 리소스 설정: <br> &nbsp;&nbsp;- requests: cpu: "100m", memory: "512Mi" <br> &nbsp;&nbsp;- limits: cpu: "700m", memory: "1Gi" <br> - 복제 수 (Replicas): 1 <br> --- <br> ## 조직 내부 정책 <br> > ### 조직 내부 정책 <br> - 레이블 규칙 <br> &nbsp;&nbsp;- 모든 Kubernetes 리소스에는 다음 레이블을 필수로 포함해야 합니다. <br> &nbsp;&nbsp;&nbsp;&nbsp;- app: [microservice-name] (e.g., app: user-service) <br> &nbsp;&nbsp;&nbsp;&nbsp;- project: gift-service <br> &nbsp;&nbsp;&nbsp;&nbsp;- tier: backend 또는 tier: frontend <br> - 리소스 할당 기준 <br> &nbsp;&nbsp;- 모든 컨테이너는 리소스 요청(requests)과 한계(limits)를 명시적으로 설정해야 합니다. <br> &nbsp;&nbsp;- 최소 요청량: cpu: "50m", memory: "128Mi" |
| **source_12** | - 최소 요청량: cpu: "50m", memory: "128Mi" <br> - 최대 한계량: cpu: "1500m", memory: "2Gi" <br> - 초기 리소스 할당은 위에 정의된 값을 따르며, 운영 모니터링 데이터를 기반으로 분기별로 재조정합니다. <br> - 보안 및 운영 정책 <br>   - 이미지 태그: 안정적인 배포를 위해 latest 태그 사용을 금지하고, 반드시 명시적인 버전 태그(e.g., 2.1)를 사용해야 합니다. <br>   - Secret 관리: <br>     - ConfigMap: 일반적인 구성 변수, 서비스 URI 등 비민감성 데이터를 저장합니다. <br>     - Secret: |
| **source_13** | - ConfigMap: 일반적인 구성 변수, 서비스 URI 등 비민감성 데이터를 저장합니다. <br> - Secret: <br>   - API 키, DB 접속 정보, JWT 시크릿 키 등 민감 데이터를 저장합니다. <br>   - 모든 Secret 값은 사전에 Base64 인코딩하여 data 필드에 저장해야 합니다. <br>   - stringData 사용은 금지합니다. |